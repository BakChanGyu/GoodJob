<html layout:decorate="~{layout/layout.html}">
<head>
    <title>게시글 상세 페이지</title>
    <style>
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #000;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
        }
    </style>
</head>
<body>
<main layout:fragment="main" class="container my-3 mx-auto">
    <div class="container mx-auto p-8 w-1/2">
        <div class="flex items-center justify-between h-16">
            <a href="/article/list" class="text-2xl font-bold flex-grow">채팅방 목록</a>
        </div>
        <ul class="container">
            <li class="bg-neutral text-white p-3 flex justify-between border-b h-11 rounded-md">
                <div class="text-sm flex items-center w-12">번호</div>
                <div class="text-sm flex items-center w-1/4 justify-center">상대방 이름</div>
                <div class="text-sm flex items-center w-1/4 justify-center">신청 시간</div>
                <div class="text-sm flex items-center w-1/4 justify-center invisible">입장</div>
            </li>
            <li th:each="room, roomStat : ${list}" class="bg-white p-3 flex justify-between border-b h-11" th:if="${room.sender.nickname == @rq.member.nickname}">
                <div class="text-sm flex items-center w-12" th:text="${list.size() - roomStat.count + 1}"></div>
                <div class="text-sm flex items-center w-1/4 justify-center" th:text="${#strings.equals(room.sender.nickname, myNickname) ? room.receiver.nickname : room.sender.nickname}"></div>
                <div class="text-sm flex items-center w-1/4 justify-center" th:text="${#temporals.format(room.reservationTime, 'yy.MM.dd HH:00')} + ' ~ ' + ${#temporals.format(room.reservationTime.plusHours(1), 'HH:00')}"></div>
                <div class="text-sm flex items-center w-1/4 justify-end pr-4">
                    <a th:if="${room.status == 0}">
                        <p class="text-sm">대기중...</p>
                    </a>
                    <a th:if="${room.status == 1}" th:href="@{/chat/room(roomId=${room.roomId})}">
                        <p class="text-sm underline">입장</p>
                    </a>
                    <a th:if="${room.status == 2}" th:href="@{/chat/delete/room(roomId=${room.roomId})}" onclick="return confirm('정말로 삭제하시겠습니까?')">
                        <p class="text-sm tooltip">
                            ❌
                            <span class="tooltip-text">신청이 거절되었습니다.</span>
                        </p>
                    </a>
                    <a th:if="${room.status == 3}" th:href="@{/chat/room(roomId=${room.roomId})}">
                        <p class="text-sm underline">종료됨</p>
                    </a>
                </div>
            </li>
            <li th:each="room, roomStat : ${list}" class="bg-white p-3 flex justify-between border-b h-11" th:if="${room.receiver.nickname == @rq.member.nickname and room.visible}">
                <div class="text-sm flex items-center w-12" th:text="${list.size() - roomStat.count + 1}"></div>
                <div class="text-sm flex items-center w-1/4 justify-center" th:text="${#strings.equals(room.sender.nickname, myNickname) ? room.receiver.nickname : room.sender.nickname}"></div>
                <div class="text-sm flex items-center w-1/4 justify-center" th:text="${#temporals.format(room.reservationTime, 'yy.MM.dd HH:00')} + ' ~ ' + ${#temporals.format(room.reservationTime.plusHours(1), 'HH:00')}"></div>
                <div class="text-sm flex items-center w-1/4 justify-end pr-4">
                    <div th:if="${room.status == 0}">
                        <a th:href="@{/chat/permit/room(roomId=${room.roomId})}">✅</a>
                        <a th:href="@{/chat/reject/room(roomId=${room.roomId})}">❌</a>
                    </div>
                    <a th:if="${room.status == 1}" th:href="@{/chat/room(roomId=${room.roomId})}">
                        <p class="text-sm underline">입장</p>
                    </a>
                    <a th:if="${room.status == 2}" th:href="@{/chat/delete/room(roomId=${room.roomId})}" onclick="return confirm('정말로 삭제하시겠습니까?')">
                        <p class="text-sm tooltip">
                            ❌
                            <span class="tooltip-text">거절한 채팅방입니다.</span>
                        </p>
                    </a>
                    <a th:if="${room.status == 3}" th:href="@{/chat/room(roomId=${room.roomId})}">
                        <p class="text-sm underline">종료됨</p>
                    </a>
                </div>
            </li>


            </li>

        </ul>
    </div>
    </main>

    </body>
</html>